(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const r of t.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function c(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function o(e){if(e.ep)return;e.ep=!0;const t=c(e);fetch(e.href,t)}})();const n=new URLSearchParams(window.location.search);var g;if(n.get("proxy")!==null){const l=n.get("sbxid");(g=document.querySelector("#app"))==null||g.remove();const s=document.createElement("iframe");s.src=`/?sbxid&${n.get("debug")!==null?"debug&":""}${n.get("ready")!==null?"ready&":""}`,n.getAll("sandbox").flatMap(t=>t.split(/[+,; ]/gui)).forEach(t=>s.sandbox.add(t)),s.style.display="block",s.style.width="100vw",s.style.height="100vh",s.style.border="none",s.style.position="fixed",s.style.top="0",s.style.left="0",document.body.appendChild(s);const o=t=>{var r;t.data&&t.data.sbx&&(n.get("debug")!==null&&console.log("[sbjs] event send to inner",t),(r=s.contentWindow)==null||r.postMessage(t.data,"*"))};window.addEventListener("message",o);const e=t=>{if(t.data&&t.data.sbxRs){if(n.get("debug")!==null&&console.log("[sbjs] event send to parent",t),l!==null&&t.data.sandboxId&&t.data.sandboxId!==l)return;window.parent.postMessage(t.data,"*")}};window.addEventListener("message",e)}else if(n.get("sbxid")===void 0&&!window.location.pathname.startsWith("/docs"))window.location.replace("/docs/");else{try{history.replaceState(null,"","/")}catch{}const s=async o=>{var f;let e=o.data;try{e=JSON.parse(e)}catch{}if(!e.sbx)return;const t=a=>{var i;console.warn("Error in iframe code:",a),(i=o.source)==null||i.postMessage({sbxRs:!0,success:!1,error:a,id:(e==null?void 0:e.id)??"no id"},{targetOrigin:o.origin})};if(typeof e!="object")return t("Event.data is not object");if(typeof e.code!="string")return t("Event.data.code is not string");if(typeof e.id!="string")return t("Event.data.id is not string");n.get("debug")!==null&&console.log("[sbjs] event",o);const r=e.code,d=e.id,u=((f=o==null?void 0:o.data)==null?void 0:f.resolve)??null,p=new Function(`return (async () => { ${r} })();`);try{const a=await p(),i={sbxRs:!0,success:!0,result:JSON.parse(JSON.stringify(a)??null),id:d};if(u)return u(i);window.parent.postMessage(i,"*")}catch(a){const i={sbxRs:!0,success:!1,error:JSON.parse(JSON.stringify(a)),id:d};if(u)return u(i);window.parent.postMessage(i,"*")}};window.addEventListener("message",s,!1);const c=async o=>{let e;const t=new Promise(d=>e=d);for(;typeof e>"u";)await new Promise(d=>setTimeout(d,1));const r=new MessageEvent("message",{data:{code:o,id:"sbjs_eval_"+Math.random().toString(36).substring(7),resolve:e,sbx:!0},origin:"*"});return window.dispatchEvent(r),await t};n.get("ready")!==null&&c("console.log('[sbjs] ready')"),window.evaluate=c,window.parent.postMessage({sbxRs:!0,sbjs_ready:!0},"*")}
